<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MTR Setup Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <img src="../../Bane_NOR_logo.svg.png" alt="Bane NOR Logo" class="logo">
                <h1>MTR Setup Assistant</h1>
                <button id="quitButton" class="quit-button">Quit</button>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="welcome">Welcome</button>
            <button class="tab-btn" data-tab="intune">Intune Provisioning</button>
            <button class="tab-btn" data-tab="account">Resource Account Management</button>
        </nav>

        <main>
            <!-- Welcome Tab -->
            <div class="tab-content active" id="welcome">
                <div class="welcome-section">
                    <h2>Welcome to MTR Setup Assistant</h2>
                    <p>Choose one of the following options to get started:</p>
                    <div class="steps">
                        <div class="step">
                            <h3>Intune Device Provisioning</h3>
                            <p>Register and validate your Logitech device in Microsoft Intune. This process ensures your device is properly registered in your organization's device management system, enabling secure access and automated configuration. Simply enter the serial number, validate its format, and the system will handle the provisioning process.</p>
                        </div>
                        <div class="step">
                            <h3>Resource Account Management</h3>
                            <p>Create and configure Teams resource accounts with comprehensive management features. This includes automatic license assignment, group membership configuration, and proper display name formatting. The system will handle all necessary Azure AD configurations, ensuring your meeting room is properly set up with the correct permissions and access levels for seamless Teams integration.</p>
                        </div>
                    </div>
                    <div class="welcome-buttons">
                        <button class="start-btn" data-goto="intune">Start Device Setup</button>
                        <button class="start-btn" data-goto="account">Create Resource Account</button>
                    </div>
                </div>
            </div>

            <!-- Intune Provisioning Tab -->
            <div class="tab-content" id="intune">
                <div class="form-section">
                    <h2>Device Information</h2>
                    <div class="form-group">
                        <label for="serialNumber">Serial Number:</label>
                        <input type="text" id="serialNumber" required>
                        <div class="validation-message" id="serialValidation"></div>
                        <div class="requirements-note">
                            <span class="requirement-icon">ℹ️</span>
                            <span class="requirement-text">Serial number must be exactly 12 characters long and end with '2'</span>
                        </div>
                    </div>
                </div>

                <div id="deviceSetupSection" class="form-section hidden">
                    <h2>Device Setup</h2>
                    <div class="form-group">
                        <label for="description">Device Description:</label>
                        <input type="text" id="description" required>
                        <small>Example: Logitech Device B260</small>
                    </div>
                    <button type="button" id="provisionIntuneBtn" class="provision-btn">Provision in Intune</button>
                </div>
            </div>

            <!-- Resource Account Tab -->
            <div class="tab-content" id="account">
                <form id="setupForm" class="setup-form">
                    <div class="form-section">
                        <h2>Account Information</h2>
                        <div class="form-group">
                            <label for="upn">User Principal Name (UPN):</label>
                            <input type="email" id="upn" required>
                            <small>Example: room01@banenor.no</small>
                        </div>
                        <div class="form-group">
                            <label for="displayName">Display Name:</label>
                            <input type="text" id="displayName" required>
                            <small>Example: Meeting Room 01</small>
                        </div>
                        <button type="submit" class="submit-btn">Create Resource Account</button>
                    </div>
                </form>
            </div>

            <div id="results" class="results hidden">
                <h2>Setup Results</h2>
                <div class="result-section">
                    <h3>Device Status</h3>
                    <pre id="deviceStatus"></pre>
                </div>
                <div class="result-section">
                    <h3>User Account Status</h3>
                    <pre id="userStatus"></pre>
                </div>
                <div class="result-section">
                    <h3>Group Memberships</h3>
                    <pre id="groupStatus"></pre>
                </div>
                <button id="resetBtn" class="reset-btn">Setup Another Device</button>
            </div>
        </main>

        <div id="loader" class="loader hidden">
            <div class="spinner"></div>
            <p>Setting up device...</p>
        </div>

        <div id="toast" class="toast hidden">
            <span id="toastMessage"></span>
        </div>
    </div>
    <script type="module" src="index.js"></script>
</body>
</html> 