<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MTR Setup Assistant</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <img src="../../Bane_NOR_logo.svg.png" alt="Bane NOR Logo" class="logo">
                <h1>MTR Setup Assistant</h1>
                <button id="quitButton" class="quit-button">Quit</button>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="welcome">Welcome</button>
            <button class="tab-btn" data-tab="intune">Intune Provisioning</button>
            <button class="tab-btn" data-tab="account">Resource Account Management</button>
        </nav>

        <main>
            <!-- Welcome Tab -->
            <div class="tab-content active" id="welcome">
                <div class="welcome-section">
                    <h2>Welcome to MTR Setup Assistant</h2>
                    <p>Select one of the following options:</p>
                    <div class="steps">
                        <div class="step">
                            <h3>Intune Device Provisioning</h3>
                            <p>Register your Logitech MTR device with Microsoft Intune.</p>
                            <ul class="feature-list">
                                <li>Validate device serial numbers</li>
                                <li>Check if device is already in Intune</li>
                                <li>Register device in Intune if needed</li>
                            </ul>
                            <button class="start-btn feature-btn" data-goto="intune">Register New Device</button>
                        </div>
                        <div class="step">
                            <h3>Resource Account Management</h3>
                            <p>Create and configure Microsoft Teams accounts for meeting rooms.</p>
                            <ul class="feature-list">
                                <li>Validate resource account existence and password</li>
                                <li>Update account password</li>
                                <li>Assign group memberships for licenses</li>
                            </ul>
                            <button class="start-btn feature-btn" data-goto="account">Set Up Resource Account</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Intune Provisioning Tab -->
            <div class="tab-content" id="intune">
                <div class="form-section centered-section">
                    <h2>Register Logitech MTR Device in Intune</h2>
                    <div class="form-group">
                        <div class="requirements-note">
                            <span class="requirement-icon">ℹ️</span>
                            <span class="requirement-text">This tab allows you to register Logitech MTR devices in Microsoft Intune. Enter the device serial number (must be exactly 12 characters and end with '2'), then click Check to verify if it's already registered.</span>
                        </div>
                        <label for="serialNumber">Input Serial Number:</label>
                        <div class="input-with-button">
                            <input type="text" id="serialNumber" required placeholder="e.g., 123456789012">
                            <button type="button" id="checkSerialBtn" class="check-btn" disabled>Check</button>
                        </div>
                        <div class="validation-message" id="serialValidation"></div>
                    </div>
                </div>

                <div id="deviceSetupSection" class="form-section centered-section hidden">
                    <h2>Provision New Device</h2>
                    <div class="form-group">
                        <label for="provisionSerialNumber">Serial Number:</label>
                        <input type="text" id="provisionSerialNumber" readonly>
                    </div>
                    <div class="form-group">
                        <label for="description">Device Description:</label>
                        <input type="text" id="description" required placeholder="Enter a description for this device">
                        <small>Example: Logitech Rallybar B260 S33</small>
                    </div>
                    <button type="button" id="provisionIntuneBtn" class="provision-btn">Register in Intune</button>
                    <div id="permanentSuccessMessage" class="permanent-success-message hidden"></div>
                    <button id="resetBtn" class="reset-btn">Setup Another Device</button>
                </div>
            </div>

            <!-- Resource Account Tab -->
            <div class="tab-content" id="account">
                <form id="setupForm" class="setup-form">
                    <div class="form-section">
                        <h2>Account Information</h2>
                        <div class="form-group">
                            <label for="upn">User Principal Name (UPN):</label>
                            <input type="email" id="upn" required>
                            <small>Example: room01@banenor.no</small>
                        </div>
                        <div class="form-group">
                            <label for="displayName">Display Name:</label>
                            <input type="text" id="displayName" required>
                            <small>Example: Meeting Room 01</small>
                        </div>
                        <button type="submit" class="submit-btn">Create Room Account</button>
                    </div>
                </form>
            </div>

            <div id="results" class="results hidden">
                <h2>Setup Results</h2>
                <div class="result-section">
                    <h3>Device Status</h3>
                    <pre id="deviceStatus"></pre>
                </div>
                <div class="result-section">
                    <h3>User Account Status</h3>
                    <pre id="userStatus"></pre>
                </div>
                <div class="result-section">
                    <h3>Group Memberships</h3>
                    <pre id="groupStatus"></pre>
                </div>
                <button id="resetBtn" class="reset-btn">Setup Another Device</button>
            </div>
        </main>

        <div id="loader" class="loader hidden">
            <div class="spinner"></div>
            <p id="loaderText">Checking device...</p>
        </div>

        <div id="toast" class="toast hidden">
            <span id="toastMessage"></span>
        </div>
        
        <footer class="app-footer static-footer">
            <div class="footer-content">
                <p>Created by Sopra Steria | Creator: Olav Heggelund | March 2025</p>
                <p class="license">© 2025 Bane NOR. All rights reserved.</p>
            </div>
        </footer>
    </div>
    <script type="module" src="index.js"></script>
</body>
</html> 